import{a as n}from"./axios.77c802c4.js";import{b as c}from"./index.7e56801c.js";import{a as m,r as p}from"./tokenAtom.bed01f95.js";const k=()=>{const i="http://3.38.59.40:8080/",[o,u]=c(m),[h]=c(p),t=n.create({baseURL:`${i}`});return t.interceptors.request.use(e=>{if(o){if(!e.headers)return e;e.headers.Authorization||(e.headers.Authorization="Bearer "+o)}return e},e=>Promise.reject(e)),t.interceptors.response.use(e=>e,async e=>{const r=e.config;if(r.url!=="/auth/signin"&&e.response&&e.response.status===401&&!r._retry){r._retry=!0;try{const s=n.create();delete s.defaults.headers.common.Authorization;const a=(await s.get("http://3.38.59.40:8080/api/v1/auth/refresh",{params:{refreshToken:h}})).data;return u(a),r.headers.Authorization="Bearer "+a,t(r)}catch(s){return Promise.reject(s)}}return Promise.reject(e)}),t};export{k as g};
